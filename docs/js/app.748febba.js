(function(e){function t(t){for(var n,s,c=t[0],a=t[1],l=t[2],u=0,d=[];u<c.length;u++)s=c[u],Object.prototype.hasOwnProperty.call(o,s)&&o[s]&&d.push(o[s][0]),o[s]=0;for(n in a)Object.prototype.hasOwnProperty.call(a,n)&&(e[n]=a[n]);h&&h(t);while(d.length)d.shift()();return r.push.apply(r,l||[]),i()}function i(){for(var e,t=0;t<r.length;t++){for(var i=r[t],n=!0,s=1;s<i.length;s++){var a=i[s];0!==o[a]&&(n=!1)}n&&(r.splice(t--,1),e=c(c.s=i[0]))}return e}var n={},o={app:0},r=[];function s(e){return c.p+"js/"+({about:"about"}[e]||e)+"."+{about:"f7b116dc"}[e]+".js"}function c(t){if(n[t])return n[t].exports;var i=n[t]={i:t,l:!1,exports:{}};return e[t].call(i.exports,i,i.exports,c),i.l=!0,i.exports}c.e=function(e){var t=[],i=o[e];if(0!==i)if(i)t.push(i[2]);else{var n=new Promise((function(t,n){i=o[e]=[t,n]}));t.push(i[2]=n);var r,a=document.createElement("script");a.charset="utf-8",a.timeout=120,c.nc&&a.setAttribute("nonce",c.nc),a.src=s(e);var l=new Error;r=function(t){a.onerror=a.onload=null,clearTimeout(u);var i=o[e];if(0!==i){if(i){var n=t&&("load"===t.type?"missing":t.type),r=t&&t.target&&t.target.src;l.message="Loading chunk "+e+" failed.\n("+n+": "+r+")",l.name="ChunkLoadError",l.type=n,l.request=r,i[1](l)}o[e]=void 0}};var u=setTimeout((function(){r({type:"timeout",target:a})}),12e4);a.onerror=a.onload=r,document.head.appendChild(a)}return Promise.all(t)},c.m=e,c.c=n,c.d=function(e,t,i){c.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:i})},c.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},c.t=function(e,t){if(1&t&&(e=c(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var i=Object.create(null);if(c.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var n in e)c.d(i,n,function(t){return e[t]}.bind(null,n));return i},c.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return c.d(t,"a",t),t},c.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},c.p="/infogr-raytracer-webgl/",c.oe=function(e){throw console.error(e),e};var a=window["webpackJsonp"]=window["webpackJsonp"]||[],l=a.push.bind(a);a.push=t,a=a.slice();for(var u=0;u<a.length;u++)t(a[u]);var h=l;r.push([0,"chunk-vendors"]),i()})({0:function(e,t,i){e.exports=i("56d7")},"21bb":function(e,t,i){"use strict";var n=i("2dad"),o=i.n(n);o.a},"2dad":function(e,t,i){},"56d7":function(e,t,i){"use strict";i.r(t);i("e260"),i("e6cf"),i("cca6"),i("a79d");var n=i("2b0e"),o=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{attrs:{id:"app"}},[i("router-view")],1)},r=[],s=(i("5c0b"),i("2877")),c={},a=Object(s["a"])(c,o,r,!1,null,null,null),l=a.exports,u=i("9483");Object(u["a"])("".concat("/infogr-raytracer-webgl/","service-worker.js"),{ready:function(){console.log("App is being served from cache by a service worker.\nFor more details, visit https://goo.gl/AFskqB")},registered:function(){console.log("Service worker has been registered.")},cached:function(){console.log("Content has been cached for offline use.")},updatefound:function(){console.log("New content is downloading.")},updated:function(){console.log("New content is available; please refresh.")},offline:function(){console.log("No internet connection found. App is running in offline mode.")},error:function(e){console.error("Error during service worker registration:",e)}});i("d3b7");var h=i("8c4f"),d=function(){var e=this,t=e.$createElement;e._self._c;return e._m(0)},f=[function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"home"},[i("h1",[e._v("INFOGR Raytracer WebGL")]),i("h2",[i("a",{attrs:{href:"https://github.com/cor"}},[e._v("cor")]),e._v(" & "),i("a",{attrs:{href:"https://github.com/kaiserkarel"}},[e._v("kaiserkarel")])]),i("canvas",{attrs:{id:"glCanvas",width:"800",height:"800"}})])}],g=(i("cfc3"),i("9a8c"),i("a975"),i("735e"),i("c1ac"),i("d139"),i("3a7b"),i("d5d6"),i("82f8"),i("e91f"),i("60bd"),i("5f96"),i("3280"),i("3fcc"),i("ca91"),i("25a1"),i("cd26"),i("3c5d"),i("2954"),i("649e"),i("219c"),i("170b"),i("b39a"),i("72f7"),i("ddb0"),i("3835")),p=i("b85c"),v=i("d4ec"),m=i("bee2"),b=i("ade3"),y=i("20e7"),S=(i("ac1f"),i("5319"),function(){function e(t,i,n,o){Object(v["a"])(this,e),Object(b["a"])(this,"gl",void 0),Object(b["a"])(this,"program",void 0),this.gl=t,i=this.preprocessSource(i,o),n=this.preprocessSource(n,o),this.program=this.initShaderProgram(t,i,n)}return Object(m["a"])(e,[{key:"initShaderProgram",value:function(e,t,i){var n=this.loadShader(e,e.VERTEX_SHADER,t),o=this.loadShader(e,e.FRAGMENT_SHADER,i),r=e.createProgram();return e.attachShader(r,n),e.attachShader(r,o),e.linkProgram(r),e.getProgramParameter(r,e.LINK_STATUS)?r:(alert("Unable to initialize the shader program: ".concat(e.getProgramInfoLog(r))),null)}},{key:"preprocessSource",value:function(e,t){var i=/42\/\/\$(.*)\$\/\//g;return e.replace(i,(function(e,i){return t[i]}))}},{key:"loadShader",value:function(e,t,i){var n=e.createShader(t);return e.shaderSource(n,i),e.compileShader(n),e.getShaderParameter(n,e.COMPILE_STATUS)?n:(console.error("An error occurred compiling the shaders:\n".concat(e.getShaderInfoLog(n))),e.deleteShader(n),null)}},{key:"use",value:function(){this.gl.useProgram(this.program)}},{key:"setUniform1f",value:function(e,t){this.gl.uniform1f(this.getUniformLocation(e),t)}},{key:"setUniformMatrix4fv",value:function(e,t){this.gl.uniformMatrix4fv(this.getUniformLocation(e),!1,t)}},{key:"setUniform2fv",value:function(e,t){this.gl.uniform2fv(this.getUniformLocation(e),t)}},{key:"setUniform3fv",value:function(e,t){this.gl.uniform3fv(this.getUniformLocation(e),t)}},{key:"getUniformLocation",value:function(e){return this.gl.getUniformLocation(this.program,e)}},{key:"getAttribLocation",value:function(e){return this.gl.getAttribLocation(this.program,e)}},{key:"delete",value:function(){this.gl.deleteProgram(this.program)}}]),e}()),O="precision highp float;\n\n#define M_PI 3.1415926535897932384626433832795\n\nvarying mediump vec2 screenPosition;\n\nstruct Camera\n{\n    vec2 position;\n    float zoom;\n} camera = Camera (vec2(0.0, 0.0), 0.5);\n\nstruct Ray\n{\n    vec2 origin;\n    vec2 direction;\n    float magnitude;\n};\n\nstruct Light\n{\n    vec2 position;\n    vec3 color;\n};\n\nstruct Circle\n{\n    vec2 position;\n    float radius;\n};\n\n#define LIGHT_COUNT 42//$LIGHT_COUNT$//\nuniform Light lights[LIGHT_COUNT];\n\n#define CIRCLE_COUNT 42//$CIRCLE_COUNT$//\nuniform Circle circles[CIRCLE_COUNT];\n\n\n// INTERSECTION CHECKS\nbool circleIntersects(Circle circle, Ray ray)\n{\n    vec2 posToOrigin = ray.origin - circle.position;\n    float a = dot(ray.direction, ray.direction);\n    float b = dot(ray.direction, posToOrigin);\n    float c = dot(posToOrigin, posToOrigin) - (circle.radius * circle.radius);\n    float d = (b * b) - (a * c);\n\n    if (d < 0.0) return false;\n\n    float sqrtD = sqrt(d);\n    float distance = (-b - sqrtD) / a;\n    if (distance < 0.0) distance = (-b + sqrtD) / a;\n\n    return distance > 0.0 && distance < ray.magnitude;\n}\n\n\n\n\nvec2 ToWorldSpace(vec2 screenSpacePoint)\n{\n    return (screenSpacePoint + camera.position) / camera.zoom;\n}\n\nvec3 Trace(vec2 worldPoint)\n{\n    vec3 colorAtPixel = vec3(0.0, 0.0, 0.0);\n\n    for (int i = 0; i < LIGHT_COUNT; i++) {\n\n        vec2 vectorToLight = lights[i].position - worldPoint;\n\n        // Don't forget to normalize the ray's direction\n        Ray ray = Ray(worldPoint, vectorToLight, length(vectorToLight));\n        ray.direction = normalize(ray.direction);\n\n        // Check for occlusions between ray\n        bool occluded = false;\n        for (int c = 0; c < CIRCLE_COUNT; c++) {\n            Circle circle = circles[c];\n            if (circleIntersects(circle, ray)) {\n                occluded = true;\n                break;\n            }\n        }\n        if (occluded) continue;\n\n\n        float distanceToLight = length(vectorToLight);\n        float intensity = 1.0 / (4.0 * M_PI * distanceToLight);\n\n        colorAtPixel += lights[i].color * intensity;\n    }\n\n\n    return colorAtPixel;\n}\n\n\nvoid main() {\n\n    gl_FragColor = vec4(Trace(ToWorldSpace(screenPosition)), 1.0);\n\n}\n",T="precision highp float;\n\nattribute vec4 aVertexPosition;\n\nuniform mat4 uModelViewMatrix;\nuniform mat4 uProjectionMatrix;\n\nvarying mediump vec2 screenPosition;\n\nvoid main() {\n    screenPosition = aVertexPosition.xy;\n    gl_Position = uProjectionMatrix * uModelViewMatrix * aVertexPosition;\n}\n",w=function(){function e(t,i){Object(v["a"])(this,e),Object(b["a"])(this,"gl",void 0),Object(b["a"])(this,"shader",void 0),Object(b["a"])(this,"buffers",void 0),this.gl=t,this.shader=new S(t,T,O,i),this.buffers=this.initBuffers()}return Object(m["a"])(e,[{key:"recompileShader",value:function(e){this.shader.delete(),this.shader=new S(this.gl,T,O,e)}},{key:"initBuffers",value:function(){var e=this.gl.createBuffer();this.gl.bindBuffer(this.gl.ARRAY_BUFFER,e);var t=[-1,1,1,1,-1,-1,1,-1];return this.gl.bufferData(this.gl.ARRAY_BUFFER,new Float32Array(t),this.gl.STATIC_DRAW),{position:e}}},{key:"drawScene",value:function(e){this.gl.clearColor(0,0,0,1),this.gl.clear(this.gl.COLOR_BUFFER_BIT),this.gl.clearDepth(1),this.gl.enable(this.gl.DEPTH_TEST),this.gl.depthFunc(this.gl.LEQUAL),this.gl.clear(this.gl.COLOR_BUFFER_BIT|this.gl.DEPTH_BUFFER_BIT);var t=45*Math.PI/180,i=this.gl.canvas.clientWidth/this.gl.canvas.clientHeight,n=.1,o=100,r=y["a"].create();y["a"].perspective(r,t,i,n,o);var s=y["a"].create();y["a"].translate(s,s,[0,0,-2.5]);var c=this.shader.getAttribLocation("aVertexPosition");this.gl.bindBuffer(this.gl.ARRAY_BUFFER,this.buffers.position),this.gl.vertexAttribPointer(c,2,this.gl.FLOAT,!1,0,0),this.gl.enableVertexAttribArray(c),this.shader.use(),this.setLightUniforms(e),this.setCircleUniforms(e),this.shader.setUniformMatrix4fv("uProjectionMatrix",r),this.shader.setUniformMatrix4fv("uModelViewMatrix",s);var a=0,l=4;this.gl.drawArrays(this.gl.TRIANGLE_STRIP,a,l)}},{key:"setLightUniforms",value:function(e){var t,i=Object(p["a"])(e.lights.entries());try{for(i.s();!(t=i.n()).done;){var n=Object(g["a"])(t.value,2),o=n[0],r=n[1];this.shader.setUniform2fv("lights[".concat(o,"].position"),new Float32Array(r.position)),this.shader.setUniform3fv("lights[".concat(o,"].color"),new Float32Array(r.color))}}catch(s){i.e(s)}finally{i.f()}}},{key:"setCircleUniforms",value:function(e){var t,i=Object(p["a"])(e.circles.entries());try{for(i.s();!(t=i.n()).done;){var n=Object(g["a"])(t.value,2),o=n[0],r=n[1];this.shader.setUniform2fv("circles[".concat(o,"].position"),new Float32Array(r.position)),this.shader.setUniform1f("circles[".concat(o,"].radius"),r.radius)}}catch(s){i.e(s)}finally{i.f()}}}]),e}(),P=w;i("d81d"),i("13d5"),i("4160"),i("159b"),i("3410");function C(e){return Object.assign(Object.create(Object.getPrototypeOf(e)),JSON.parse(JSON.stringify(e)))}var _=function(){function e(){Object(v["a"])(this,e),Object(b["a"])(this,"lights",[{position:[1,1],color:[1,1,1]}]),Object(b["a"])(this,"circles",[{position:[0,0],radius:.1}]),Object(b["a"])(this,"duration",1)}return Object(m["a"])(e,[{key:"clone",value:function(){return C(this)}},{key:"interpolate",value:function(e,t){var i=arguments.length>2&&void 0!==arguments[2]&&arguments[2],n=this.clone();return i||(t=(Math.sin((t-.5)*Math.PI)+1)/2),this.lights.forEach((function(i,o){for(var r in n.lights[o].position)n.lights[o].position[r]=i.position[r]+t*(e.lights[o].position[r]-i.position[r]);for(var s in n.lights[o].color)n.lights[o].color[s]=i.color[s]+t*(e.lights[o].color[s]-i.color[s])})),this.circles.forEach((function(i,o){for(var r in n.circles[o].position)n.circles[o].position[r]=i.position[r]+t*(e.circles[o].position[r]-i.position[r]);n.circles[o].radius=i.radius+t*(e.circles[o].radius-i.radius)})),n}},{key:"addLight",value:function(){this.lights.push(C(this.lights[this.lights.length-1]))}},{key:"addCircle",value:function(){this.circles.push(C(this.circles[this.circles.length-1]))}}]),e}(),L=function(){function e(t,i){Object(v["a"])(this,e),Object(b["a"])(this,"scenes",[new _]),Object(b["a"])(this,"shaderSourceVars",void 0),this.shaderSourceVars={LIGHT_COUNT:t,CIRCLE_COUNT:i};for(var n=1;n<t;n++)this.lastScene().addLight();for(var o=1;o<i;o++)this.lastScene().addCircle()}return Object(m["a"])(e,[{key:"sceneDurations",value:function(){return this.scenes.map((function(e){return e.duration}))}},{key:"duration",value:function(){return this.sceneDurations().reduce((function(e,t){return e+t}),0)}},{key:"lastScene",value:function(){return this.scenes[this.scenes.length-1]}},{key:"addScene",value:function(){return this.scenes.push(this.lastScene().clone()),this.lastScene()}},{key:"currentScene",value:function(e){var t=this.sceneDurations(),i=this.scenes.length;e%=this.duration();var n=0,o=-1;while(n<e)o++,n+=t[o],o%=i;var r=this.scenes[o],s=o+1===i?this.scenes[0]:this.scenes[o+1],c=(e-n+r.duration)/r.duration;return r.interpolate(s,c)}}]),e}();function j(){var e=new L(4,9),t=e.lastScene();return t.lights[0].position=[-2.5,2.5],t.lights[0].color=[0,0,0],t.lights[1].position=[0,0],t.lights[2].position=[0,0],t.lights[3].position=[0,0],t.lights[1].color=[0,0,0],t.lights[2].color=[0,0,0],t.lights[3].color=[0,0,0],t=e.addScene(),t.lights[0].color=[2,2,2],t.duration=2,t=e.addScene(),t=e.addScene(),t.lights[0].position=[-.5,.5],t.duration=.5,t=e.addScene(),t=e.addScene(),t.lights[0].position=[.5,.5],t.lights[0].color=[2,0,0],t=e.addScene(),t.lights[0].position=[.5,-.5],t.lights[0].color=[1,1,0],t=e.addScene(),t.lights[0].position=[-.5,-.5],t.lights[0].color=[0,2,0],t=e.addScene(),t.lights[0].position=[-.5,.5],t.lights[0].color=[0,0,2],t=e.addScene(),t.lights[0].color=[2,1,3],t.duration=2,t=e.addScene(),t.circles[0].position=[-1,-1],t.circles[1].position=[1,1],t.circles[2].position=[1,-1],t.circles[3].position=[1,-1],t.circles[4].position=[1,-1],t.circles[5].position=[1,-1],t.circles[6].position=[1,-1],t.circles[7].position=[1,-1],t.circles[8].position=[1,-1],t.lights[0].position=[0,0],t=e.addScene(),t.circles[3].position=[1,0],t.circles[4].position=[0,-1],t=e.addScene(),t.circles[0].radius=.2,t.circles[1].radius=.2,t.circles[3].radius=.15,t.circles[4].radius=.15,t=e.addScene(),t.lights[0].color=[1,1,4],t=e.addScene(),t.lights[1].color=[9,4,8],t=e.addScene(),t.lights[1].position=[0,1.8],t.duration=1,t=e.addScene(),t.lights[1].position=[1.8,1.8],t=e.addScene(),t.lights[1].position=[1.8,-1.8],t=e.addScene(),t.lights[1].position=[-1.8,-1.8],t=e.addScene(),t.lights[1].position=[-1.8,0],t=e.addScene(),t.lights[1].position=[0,0],t=e.addScene(),t.circles[0].radius=.1,t.circles[1].radius=.1,t.circles[2].radius=.1,t.circles[3].radius=.1,t.circles[4].radius=.1,t=e.addScene(),t.circles[5].position=[1,.5],t.circles[6].position=[1,-.5],t.circles[7].position=[.5,-1],t.circles[8].position=[-.5,-1],t=e.addScene(),t.lights[0].color=[0,0,0],t.lights[1].color=[0,0,0],t.lights[2].color=[0,0,0],t.lights[3].color=[0,0,0],t=e.addScene(),t.lights[0].position=[1.8,.7],t.lights[1].position=[1.8,-.7],t.lights[2].position=[.7,-1.8],t.lights[3].position=[-.7,-1.8],t.duration=.5,t=e.addScene(),t.lights[0].color=[0,2,0],t=e.addScene(),t.lights[0].color=[0,0,0],t.lights[1].color=[0,2,0],t=e.addScene(),t.lights[1].color=[0,0,0],t.lights[2].color=[0,2,0],t=e.addScene(),t.lights[2].color=[0,0,0],t.lights[3].color=[0,2,0],t=e.addScene(),t.lights[3].color=[0,0,0],t=e.addScene(),t.lights[0].color=[0,2,0],t.lights[1].color=[0,2,0],t.lights[2].color=[0,2,0],t.lights[3].color=[0,2,0],t.duration=3,t=e.addScene(),t.lights[0].position=[1.8,-1.8],t.lights[1].position=[1.8,-1.8],t.lights[2].position=[1.8,-1.8],t.lights[3].position=[1.8,-1.8],t=e.addScene(),t.lights[0].position=[5,-5],t.lights[1].position=[5,-5],t.lights[2].position=[5,-5],t.lights[3].position=[5,-5],t=e.addScene(),t.duration=1,t.lights[0].position=[-2.5,2.5],t.lights[1].position=[-2.5,2.5],t.lights[2].position=[-2.5,2.5],t.lights[3].position=[-2.5,2.5],t.lights[0].color=[0,0,0],t.lights[1].color=[0,0,0],t.lights[2].color=[0,0,0],t.lights[3].color=[0,0,0],e}var k={name:"Home",data:function(){return{raytracer:null,movie:j()}},mounted:function(){var e=document.querySelector("#glCanvas"),t=e.getContext("webgl");null===t&&alert("Unable to initialize WebGL. Your browser or machine may not support it."),this.raytracer=new P(t,this.movie.shaderSourceVars),this.playMovie()},methods:{playMovie:function(){var e=this,t=0,i=function i(n){n*=.001,t+=n-t,e.raytracer.drawScene(e.movie.currentScene(t)),requestAnimationFrame(i)};requestAnimationFrame(i)}}},U=k,A=(i("21bb"),Object(s["a"])(U,d,f,!1,null,null,null)),E=A.exports;n["a"].use(h["a"]);var R=[{path:"/",name:"Home",component:E},{path:"/about",name:"About",component:function(){return i.e("about").then(i.bind(null,"f820"))}}],x=new h["a"]({mode:"history",base:"/infogr-raytracer-webgl/",routes:R}),I=x,M=i("2f62");n["a"].use(M["a"]);var F=new M["a"].Store({state:{},mutations:{},actions:{},modules:{}});n["a"].config.productionTip=!1,new n["a"]({router:I,store:F,render:function(e){return e(l)}}).$mount("#app")},"5c0b":function(e,t,i){"use strict";var n=i("9c0c"),o=i.n(n);o.a},"9c0c":function(e,t,i){}});
//# sourceMappingURL=app.748febba.js.map